import numpy as np
                                                                     
def lanczos_diff_2d(tag,yy,dsx_in,dsy_in):
	res1 = yy*0.0
	res2 = yy*0.0

	if (tag == -3):
		res1[1:-1,:] = (yy[:-2,:]-yy[2:,:])/(2.0*dsx_in)
		res2[:,1:-1] = (yy[:,:-2]-yy[:,2:])/(2.0*dsy_in)
	
	if (tag == -2):
		res1[2:-2,:] = (yy[0:-4,:]-yy[4:,:]-8.0*(yy[1:-3,:]-yy[3:-1,:]))/(12.0*dsx_in)
		res2[:,2:-2] = (yy[:,0:-4]-yy[:,4:]-8.0*(yy[:,1:-3]-yy[:,3:-1]))/(12.0*dsy_in)
	 
	if (tag == -1):
		res1[2:-2,:] = ((yy[4:,:]-yy[0:-4,:])+2.0*(yy[3:-1,:]-yy[1:-3,:]))/(8.0*dsx_in)
		res2[:,2:-2] = ((yy[:,4:]-yy[:,0:-4])+2.0*(yy[:,3:-1]-yy[:,1:-3]))/(8.0*dsy_in)
	
	if (tag == 0):
		res1[3:-3,:] = (5.0*(yy[4:-2,:]-yy[2:-4,:])+4.0*(yy[5:-1,:]-yy[1:-5,:])+1.0*(yy[6:,:]-yy[0:-6,:]))/(32.0*dsx_in)
		res2[:,3:-3] = (5.0*(yy[:,4:-2]-yy[:,2:-4])+4.0*(yy[:,5:-1]-yy[:,1:-5])+1.0*(yy[:,6:]-yy[:,0:-6]))/(32.0*dsy_in)
	
	if (tag == 1):
		res1[3:-3,:] = (1.0*(yy[4:-2,:]-yy[2:-4,:])+2.0*(yy[5:-1,:]-yy[1:-5,:])+3.0*(yy[6:,:]-yy[0:-6,:]))/(28.0*dsx_in)
		res2[:,3:-3] = (1.0*(yy[:,4:-2]-yy[:,2:-4])+2.0*(yy[:,5:-1]-yy[:,1:-5])+3.0*(yy[:,6:]-yy[:,0:-6]))/(28.0*dsy_in)
	
	if (tag == 2):
		res1[3:-3,:] = (39.0*(yy[4:-2,:]-yy[2:-4,:])+12.0*(yy[5:-1,:]-yy[1:-5,:])-5.0*(yy[6:,:]-yy[0:-6,:]))/(96.0*dsx_in)
		res2[:,3:-3] = (39.0*(yy[:,4:-2]-yy[:,2:-4])+12.0*(yy[:,5:-1]-yy[:,1:-5])-5.0*(yy[:,6:]-yy[:,0:-6]))/(96.0*dsy_in)
	
	return res1,res2
